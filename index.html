<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirect Based on User Phone OS</title>
</head>
<body>
    <script>
        var androidUrl = "https://play.google.com/store/apps/details?id=com.pacificprimecxa.android";
        var iosUrl = "https://apps.apple.com/us/app/pacific-prime-cxa-benefits/id6462017741";
        var customAndroidScheme = "ppcxa://server/prod";
        var customIOSScheme = "ppcxa://server/prod";

        window.onload = function() {
            var userAgent = navigator.userAgent || navigator.vendor || window.opera;
            var timeoutId;

            if (/android/i.test(userAgent)) {
                // Check if the custom scheme is supported
                if (isCustomSchemeSupported(customAndroidScheme)) {
                    window.location.href = customAndroidScheme;
                } else {
                    window.open(androidUrl, '_blank');
                }
            } else if (/iPad|iPhone|iPod/i.test(userAgent)) {
                // Check if the custom scheme is supported
                if (isCustomSchemeSupported(customIOSScheme)) {
                    window.location.href = customIOSScheme;
                } else {
                    window.open(iosUrl, '_blank');
                }
            }

            // Function to check if the custom scheme is supported
            function isCustomSchemeSupported(scheme) {
                var iframe = document.createElement("iframe");
                iframe.style.display = "none";
                iframe.src = scheme + "://";
                document.body.appendChild(iframe);
                setTimeout(function() {
                    document.body.removeChild(iframe);
                }, 3000); // Adjust timeout as needed
                return true; // If the custom scheme is supported, the iframe will load successfully
            }

            // Clear the timeout if the page is hidden (app has been opened)
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    clearTimeout(timeoutId);
                }
            });
        }
    </script>
</body>
</html>
